SELECT model_input.*, CASE WHEN NOT Panorama IS NULL OR  TRUE  AND   Panorama='Lluvioso' AND TRUE THEN 'No' WHEN NOT Panorama IS NULL OR  TRUE  AND   Panorama='Nublado' AND TRUE THEN 'Si' WHEN NOT Panorama IS NULL OR  TRUE  AND   Panorama='Soleado' AND TRUE THEN 'Si' END FROM (SELECT primkey, Panorama AS Panorama, Temp AS Temp, Humedad AS Humedad, Viento AS Viento FROM input AS ms_input) AS model_input